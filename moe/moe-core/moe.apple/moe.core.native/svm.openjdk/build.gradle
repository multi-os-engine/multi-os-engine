import org.moe.prebuilts.Script

task('compile_libjava', type: Script) {
    doFirst {
        delete("build/xcode")
    }
    progress 'Build libjava'
    rawWorkDir "${external.svm.root}/labs-openjdk-17"
    exec 'sh', 'buildJdk.sh'
    doLast {
        copy {
            from("${external.svm.root}/labs-openjdk-17/xcode/")
            include("*.a")
            into("build/xcode")
        }
        file("build/xcode/jdk-ios-d.a").renameTo(file("build/xcode/Debug-ios-iphoneos-libjava.a"))
        file("build/xcode/jdk-ios-r.a").renameTo(file("build/xcode/Release-ios-iphoneos-libjava.a"))
        file("build/xcode/jdk-ios-simulator-d.a").renameTo(file("build/xcode/Debug-ios-iphonesimulator-libjava.a"))
        file("build/xcode/jdk-ios-simulator-r.a").renameTo(file("build/xcode/Release-ios-iphonesimulator-libjava.a"))
    }
}